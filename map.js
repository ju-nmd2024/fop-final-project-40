import Entity from "./entities/entity.js";
import { getFramesPos, drawSprite } from "../utils.js";

export default class Map extends Entity {
    constructor() {
        super();
        this.tileSize = 16,

        this.tileMap1 = null;
        this.tileMap2 = null;
        this.tileMap2 = null;

        this.tiles1 = [
            [7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7],
            [7, 7, 7, 7, 7, 7, 7, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7],
            [7, 7, 6, 7, 7, 7, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 9, 9, 9, 9, 9, 9, 9, 9, 7, 7, 7, 7, 7, 7, 7],
            [7, 7, 7, 6, 7, 7, 6, 6, 7, 6, 6, 7, 7, 0, 0, 7, 7, 7, 7, 6, 7, 7, 0, 0, 0, 0, 0, 0, 7, 7, 7, 6, 6, 7],
            [7, 7, 7, 6, 7, 6, 6, 7, 7, 7, 7, 7, 7, 0, 0, 0, 0, 0, 7, 7, 7, 7, 0, 0, 0, 0, 0, 0, 7, 7, 6, 6, 6, 6],
            [7, 7, 7, 6, 7, 6, 6, 7, 6, 7, 6, 6, 7, 7, 7, 0, 0, 0, 0, 7, 7, 7, 0, 0, 0, 0, 0, 0, 7, 6, 6, 6, 6, 6],
            [7, 7, 7, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 0, 0, 0, 0, 7, 7, 0, 0, 0, 0, 7, 0, 0, 11, 6, 6, 6, 6, 6],
            [7, 7, 6, 6, 6, 8, 9, 7, 7, 7, 7, 7, 7, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 6, 6, 6, 6, 7],
            [7, 7, 6, 6, 6, 15, 0, 7, 7, 7, 7, 7, 0, 0, 0, 0, 0, 0, 0, 0, 7, 7, 7, 0, 0, 0, 0, 0, 11, 6, 6, 6, 6, 6],
            [7, 7, 6, 6, 6, 15, 0, 0, 0, 7, 7, 0, 0, 0, 0, 0, 0, 0, 0, 7, 7, 7, 7, 0, 0, 0, 0, 0, 11, 6, 6, 6, 7, 6],
            [7, 7, 7, 6, 6, 15, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 24, 24, 17, 7, 7, 0, 0, 0, 0, 0, 11, 6, 6, 6, 6, 6],
            [7, 7, 7, 6, 6, 15, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22, 25, 25, 23, 7, 0, 0, 0, 0, 0, 7, 11, 6, 6, 6, 6, 6],
            [7, 7, 7, 6, 6, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18, 19, 20, 21, 0, 0, 0, 0, 0, 0, 0, 11, 6, 6, 6, 6, 6],
            [7, 7, 7, 6, 6, 15, 0, 7, 7, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 6, 6, 6, 6, 7],
            [7, 7, 6, 6, 6, 15, 7, 7, 7, 0, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 11, 6, 6, 6, 6, 7],
            [6, 6, 6, 6, 6, 15, 7, 7, 7, 7, 0, 0, 0, 0, 0, 7, 7, 7, 0, 0, 0, 0, 0, 0, 0, 0, 7, 0, 11, 7, 6, 6, 7, 7],
            [6, 6, 6, 6, 7, 15, 6, 7, 7, 7, 0, 0, 0, 7, 7, 7, 7, 7, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 7, 6, 6, 6, 7],
            [6, 6, 6, 7, 7, 12, 13, 13, 13, 13, 13, 13, 13, 13, 7, 7, 7, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 6, 7],
            [6, 6, 7, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 6, 6, 6, 7, 7, 7, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 6],
            [6, 6, 6, 7, 7, 7, 7, 6, 6, 6, 6, 6, 6, 7, 6, 6, 6, 6, 6, 6, 6, 7, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7],
            [6, 6, 6, 6, 7, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 6, 7, 7, 7, 7],
            [6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7]
        ];
        this.tiles2 = [
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 22, 23, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 24, 25, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 30, 31, 32, 33, 34, 35, 36, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 18, 19, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 20, 21, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 9, 10, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 11, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 26, 27, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 28, 29, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 12, 13, 14, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 15, 16, 17, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 18, 19, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 20, 21, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 22, 23, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 24, 25, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 26, 27, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 28, 29, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 30, 31, 32, 33, 34, 35, 36, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 2, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 9, 10, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
            [6, 6, 6, 6, 6, 7, 0, 1, 11, 3, 2, 4, 5, 8, 6, 6, 6, 6, 6],
        ];
    }
    load() {
        this.tileMap1 = loadImage("./assets/level1.png");
        this.tileMap2 = loadImage("./assets/level2.png");
    }
    tileset1() {
        this.frames = getFramesPos(6, 5, this.tileSize, this.tileSize);

        // tiles
        this.anims = {
            "grass": 0,
            "noClipGrass": 6, "tree": 7, "fencetop1": 8, "fencetop2": 9, "fencetop3": 10, "fenceright": 11,
            "fencebot1": 12, "fencebot2": 13, "fencebot3": 14, "fenceleft": 15, "rooftop1": 16, "rooftop3": 17,
            "houseleft": 18, "door": 19, "wall": 20, "houseright": 21, "roofleft": 22, "roofright": 23,
            "rooftop2": 24, "roof": 25
        };
    }
    tileset2() {
        this.frames = getFramesPos(6, 7, this.tileSize, this.tileSize);

        // tiles
        this.anims = {
            "sidewalkLeft": 0, "roadLeft": 1, "road": 2, "roadMid": 3, "roadRight": 4, "sidewalkRight": 5,
            "noClipGrass": 6, "borderGrass1": 7, "borderGrass2": 8, "leftHole1": 9, "leftHole2": 10, "leftHole3": 11,
            "midHole1": 12, "midHole2": 13, "midHole3": 14, "midHole4": 15, "midHole5": 16, "midHole6": 17,
            "rightHole1": 18, "rightHole2": 19, "rightHole3": 20, "rightHole4": 21, "car1": 22, "car2": 23,
            "car3": 24, "car4": 25, "car5": 26, "car6": 27, "car7": 28, "car8": 29,
            "border1": 30, "border2": 31, "border3": 32, "border4": 33, "border5": 34, "border6": 35,
            "border7": 36
        };
    }
    setup() {
        this.tileset1();
        this.tileset2();
    }


    draw(tileset, camera, tilemap) {
        imageMode(CORNER);
        noStroke();
        push();
        translate(Math.floor(camera.x - 220), Math.floor(camera.y - 220));
        for (let rowIndex = 0; rowIndex < tileset.length; rowIndex++) {

            for (let colIndex = 0; colIndex < tileset[rowIndex].length; colIndex++) {

                this.tiles(tileset[rowIndex][colIndex], colIndex * this.tileSize, rowIndex * this.tileSize, tilemap);
            }
        }
        pop();
    }

    tiles(tile, x, y, tilemap) {
        drawSprite(
            tilemap,
            x,
            y,
            this.frames[tile].x,
            this.frames[tile].y,
            this.tileSize,
            this.tileSize,
        );
    }
}

